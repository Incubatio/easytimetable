{% extends "agenda/base_fullcalendar.html" %}
{% load i18n %}
{% block fullcalendar_init %}
<script type="text/javascript"> 
$(document).ready(function(){
    
    var calendar = $('#calendar').fullCalendar({
        header: {
            left: 'prev,next today',
            center: 'title',
            right: 'month,agendaWeek,agendaDay',
        },
        events: '{% url agenda:get_test_planning %}',
        selectable: true,
        selectHelper: true,
        editable: true,
        select: function(start, end, allDay) {
            var title = prompt("Yeha ?");
            calendar.fullCalendar('renderEvent', 
            {
                title: title,
                start: start,
                end: end,
                allDay: allDay,

            }, true);
        },
        eventClick: function(calEvent, jsEvent, view) {
            alert('clicked');
        },
        eventDrop: function(calEvent, delta) {
            alert('dropped');
        }
    });

    // automatically load ajax links within a modal dialog box
    $('a.ajax').click(function() {
        var url = this.href;
        var dialog = $('<div style="display:hidden"></div>').appendTo('body');
        // load remote content
        dialog.load(
            url, 
            {},
            function (responseText, textStatus, XMLHttpRequest) {
                    dialog.dialog({
                        modal: true,
                        width: '400px',
                    });
            }
        );
        //prevent the browser to follow the link
        return false;
    });

});
</script>
{% endblock %}
{% block content %}
<h2>Calendar</h2>
<div id='calendar'></div> 
{% endblock %}
{% block menu %}
<ul>
    <li><a class="ajax" href="{% url agenda:add_user_event %}" />{% trans "Add user event" %}</a></li>
</ul>
{% endblock %}
